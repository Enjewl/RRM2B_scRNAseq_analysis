# RRM2B scRNAseq analysis
Code for the single cell RNA-seq analysis in manuscript "A Primate-Specific Exon in RRM2B is Involved in Modifying Huntington’s Disease".

## Glioblastoma dataset (Processing script: Glioblastoma_dataset.R & Glioblastoma_Processing_Isoforms.sh)
The Human Glioblastoma dataset was obtained from 10X Genomics (https://www.10xgenomics.com/datasets/human-glioblastoma-multiforme-5-v-1-whole-transcriptome-analysis-1-standard-4-0-0) and consisted of human glioblastoma multiforme cells from a single male donor processed with 10X Chromium single cell 5’ v1 gene expression. Raw count matrices and genome-aligned bam files were downloaded and the expression of RRM2B isoforms in each cell type was determined as follows. Raw count matrices were processed with Seurat v5 (ref, https://www.nature.com/articles/s41587-023-01767-y). Briefly, a quality control filter was applied to remove low quality cells with gene counts less than 200. Additionally, cells with mitochondrial reads (> 10%) were removed. The read counts were normalised and scaled using the NormalizeData function in Seurat with parameters normalisation.method = LogNormalize and scale.factor = 10 000. Dimensionality reduction was performed on normalised read counts using a set of 3000 top variable genes identified through the FindVariableFeatures function in Seurat. Cell clustering was performed with the first 30 dimensions, k-nearest neighbour value of 20 and the Louvain community detection algorithm. Cell type annotation was performed by sctype (ref, https://www.nature.com/articles/s41467-022-28803-w) with default parameters and specifying the known tissue type as brain. 

Spliced reads spanning RRM2B exons 1 and 2 were extracted from the genome-aligned BAM file and designated either isoform 1 (NM_015713.5) or isoform 2 (NM_001172477.1) based on the start position of the first exon. Cell barcodes from the associated isoform 1 or 2 reads were extracted and compared against the assigned cell type from the transcriptome data.

## Human HD single cell RNA-seq dataset (Processing script: Human_HD_dataset.R)
Human HD single cell RNA-seq dataset consisted of 8 human post-mortem tissue from HD and 8 age matched unaffected controls as described in https://www.nature.com/articles/s41586-022-04521-7. Pre-processed log-normalized count matrices and cell type metadata were taken from compbio.mit.edu/scBBB/preprocessed/brain.HD.snRNAseq.counts.rds and compbio.mit.edu/scBBB/preprocessed/brain.HD.snRNAseq.metadata.txt, respectively. RRM2B log-normalized expression values per cell type were computed from the preprocessed files.
